# ЛР6. Вариант 28 и 1
### Функции в качестве параметров: вычисление корней разных уравнений разными способами разными производными разными...

> [!IMPORTANT]
> При нарушении достаточного условия сходимости (Метод итераций/Ньютона) выводится предупреждение, но выполнение не прекращается, т. к. это условие _**достаточное**, но не необходимое_.
>
> Например, в случае с методом Ньютона во втором уравнении достаточное условие сходимости нарушается в начале заданного отрезка, однако корень есть. Правильнее было задать корень `[3.118638998, 4]`, а не `[3, 4]`. 


## Код
- [**main.c**](./main.c) – запускает все методы (`run_all_methods`) сначала для `x - 2 + sin (1/x) = 0` потом для `e^x + ln x - 10x = 0`
- **methods**
  - [methods.h](./methods/methods.h) – "ручки" функций для запуска методов (с выводом) всех/каждого по отдельности
  - [newton.c](./methods/newton.c), [iterations.c](./methods/iterations.c), [dichotomy.c](./methods/dichotomy.c) – реализации методов
  - [all_methods.c](./methods/all_methods.c) – запускает все методы для уравнения, но с разными типами производных (Численное/Аналитическое)
- **common** – уравнения, производные, функции для удобного принта (aka utils)

---

# Отчёт по лабораторной работе №6 по курсу «Фундаментальная информатика»

**Тема:** Численные методы решения нелинейных уравнений. Использование функций в качестве параметров.

**Цель:** Освоить численные методы решения нелинейных уравнений (метод дихотомии, метод итераций и метод Ньютона), а также освоить использование функций в качестве параметров.

**Задание:** Реализовать программу для решения нелинейных уравнений методами дихотомии, итераций и Ньютона. Применить каждую процедуру к двум уравнениям, с анализом условий сходимости и сравнением результатов при использовании аналитических и численных производных.

> **Вариант 28:** x-2 + sin (1/x) = 0
>
> **Вариант 1:** e^x + lnx - 10x = 0

## Идея и метод решения
Основная идея работы заключается в построении универсальной программы для решения нелинейных уравнений за счёт передачи функций и их производных в качестве параметров. 
Такой подход позволяет использовать одни и те же реализации численных методов для различных уравнений.

Для каждого уравнения задаются:
- Сама функция \( F(x) \)
- Итерационная функция \( x = f(x) \)
- Первая и вторая производные (в аналитическом и численном виде)

## Структура программы
- `main.c` — точка входа, последовательный запуск всех методов для двух уравнений
- `methods/`:
  - `dichotomy.c` — реализация метода половинного деления
  - `iterations.c` — реализация метода итераций
  - `newton.c` — реализация метода Ньютона
  - `all_methods.c` — запуск всех методов с различными типами производных
- `common/` — уравнения, аналитические и численные производные, а также функции форматированного вывода результатов
  
Такое разбиение упрощает расширение программы и повторное использование численных методов

## Алгоритм

### Метод дихотомии
1. Проверяется наличие корня на отрезке \([a, b]\) по условию \( F(a) * F(b) < 0 \)
2. Отрезок последовательно делится пополам
3. На каждом шаге выбирается половина, содержащая корень
4. Процесс завершается при достижении заданной точности \( \varepsilon \)
5. Приближённое значение корня вычисляется как середина итогового отрезка

### Метод итераций
1. Исходное уравнение приводится к виду \( x = f(x) \)
2. Проверяется достаточное условие сходимости \( |f'(x)| < 1 \) на заданном отрезке
3. Начальное приближение выбирается в середине отрезка
4. Итерации продолжаются до выполнения условия точности или превышения максимального числа итераций

### Метод Ньютона
1. Итерационный процесс строится по формуле  
     x_{k+1} = x_k - F(x_k) / F'(x_k)
2. Проверяется достаточное условие сходимости  
     |F(x) * F''(x)| < (F'(x))^2
3. Начальное приближение выбирается в середине отрезка
4. Итерации продолжаются до достижения заданной точности либо остановки по лимиту
   
> [!NOTE]
> При нарушении достаточного условия в Методах Ньтона и итераций выводится предупреждение, однако выполнение не прерывается


## Сценарий выполнения работы
1. Анализ условия лабораторной работы и изучение теории о численных методах
2. Реализация функций уравнений, итерационных функций и их производных
3. Реализация методов дихотомии, итераций и Ньютона
4. Добавление проверок достаточных условий сходимости
5. Итог:
```
----- x - 2 + sin (1/x) = 0 ----------------------------------------------------------

МЕТОД ДИХОТОМИИ
Корень: 1.3077 (итераций: 40)
F(x) = 1.314504061156185e-13

=========== Аналитическое dF ===========
МЕТОД ИТЕРАЦИЙ
Корень: 1.3077 (итераций: 31)
F(x) = 3.257394354250209e-13

МЕТОД НЬЮТОНА
Корень: 1.3077 (итераций: 4)
F(x) = 1.110223024625157e-16

=========== Численное dF ===========
МЕТОД ИТЕРАЦИЙ
Корень: 1.3077 (итераций: 31)
F(x) = 3.257394354250209e-13

МЕТОД НЬЮТОНА
Корень: 1.3077 (итераций: 4)
F(x) = 1.110223024625157e-16

----- e^x + ln x - 10x = 0 -----------------------------------------------------------

МЕТОД ДИХОТОМИИ
Корень: 3.5265 (итераций: 40)
F(x) = 8.981260180007666e-12

=========== Аналитическое dF ===========
МЕТОД ИТЕРАЦИЙ
Нарушено достаточное условие сходимости метода! Не гарантировано, что корень находится на заданном отрезке
Метод не сошёлся за 1000 итераций

МЕТОД НЬЮТОНА
3.000000
Нарушено достаточное условие сходимости метода! (Про F2: корень ЕСТЬ на отрезке [3, 4], но достаточное условие сходимости выполняется только на [3.118638998, 4])
Корень: 3.5265 (итераций: 4)
F(x) = -2.664535259100376e-15

=========== Численное dF ===========
МЕТОД ИТЕРАЦИЙ
Нарушено достаточное условие сходимости метода! Не гарантировано, что корень находится на заданном отрезке
Метод не сошёлся за 1000 итераций

МЕТОД НЬЮТОНА
3.000000
Нарушено достаточное условие сходимости метода! (Про F2: корень ЕСТЬ на отрезке [3, 4], но достаточное условие сходимости выполняется только на [3.118638998, 4])
Корень: 3.5265 (итераций: 4)
F(x) = -2.664535259100376e-15
```

## Выводы

В ходе выполнения лабораторной работы были реализованы и исследованы три численных метода решения нелинейных уравнений. 

Работа показала, что метод дихотомии является наиболее устойчивым и универсальным, но обладает наименьшей скоростью сходимости, 
тогда как метод Ньютона сходится значительно быстрее, однако предъявляет более жёсткие требования к поведению функции и выбору начального приближения. 

Метод простых итераций занимает промежуточное положение и чувствителен к выбору итерационной функции. 

Использование функций и их производных в качестве параметров позволило создать гибкую архитектуру программы. 

Также было выяснено, что нарушение достаточных условий сходимости не всегда приводит к расходимости метода.


